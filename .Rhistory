ts.plot(betas_rol_mat[,4], col=1, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Cemig, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
par(mfrow=c(2,2))
ts.plot(betas_rol_mat[,1], col=1, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Petrobras, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
ts.plot(betas_rol_mat[,2], col=1, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Vale, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
ylab
# legend("bottom", col=1, lty=1,
#        legend=c('Vale'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,3], col=1, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Via_Varejo, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
# legend("bottom", col=1, lty=1,
#        legend=c('Via Varejo'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,4], col=1, lwd=2, ylim=c(min(betas_rol_mat[,4],betas$Cemig),max(betas_rol_mat[,4],betas$Cemig)), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Cemig, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
par(mfrow=c(2,2))
ts.plot(betas_rol_mat[,1], col=1, lwd=2, ylim=c(min(betas_rol_mat[,1],betas$Petrobras),max(betas_rol_mat[,1],betas$Petrobras)), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Petrobras, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
ts.plot(betas_rol_mat[,2], col=1, lwd=2, ylim=c(min(betas_rol_mat[,2],betas$Vale),max(betas_rol_mat[,2],betas$Vale)), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Vale, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
ylab
# legend("bottom", col=1, lty=1,
#        legend=c('Vale'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,3], col=1, lwd=2, ylim=c(min(betas_rol_mat[,3],betas$Via_Varejo),max(betas_rol_mat[,3],betas$Via_Varejo)), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Via_Varejo, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
# legend("bottom", col=1, lty=1,
#        legend=c('Via Varejo'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,4], col=1, lwd=2, ylim=c(min(betas_rol_mat[,4],betas$Cemig),max(betas_rol_mat[,4],betas$Cemig)), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Cemig, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
par(mfrow=c(2,2))
ts.plot(betas_rol_mat[,1], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,1],betas$Petrobras)*0.9,
max(betas_rol_mat[,1],betas$Petrobras)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Petrobras, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
ts.plot(betas_rol_mat[,2], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,2],betas$Vale)*0.9,
max(betas_rol_mat[,2],betas$Vale)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Vale, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
ylab
# legend("bottom", col=1, lty=1,
#        legend=c('Vale'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,3], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,3],betas$Via_Varejo)*0.9,
max(betas_rol_mat[,3],betas$Via_Varejo)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Via_Varejo, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
# legend("bottom", col=1, lty=1,
#        legend=c('Via Varejo'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,4], col=1, lwd=2, ylim=c(min(betas_rol_mat[,4],betas$Cemig)*0.9,max(betas_rol_mat[,4],betas$Cemig)*1,1), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Cemig, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
par(mfrow=c(2,2))
ts.plot(betas_rol_mat[,1], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,1],betas$Petrobras)*0.9,
max(betas_rol_mat[,1],betas$Petrobras)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Petrobras, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
ts.plot(betas_rol_mat[,2], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,2],betas$Vale)*0.9,
max(betas_rol_mat[,2],betas$Vale)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Vale, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
ylab
# legend("bottom", col=1, lty=1,
#        legend=c('Vale'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,3], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,3],betas$Via_Varejo)*0.9,
max(betas_rol_mat[,3],betas$Via_Varejo)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Via_Varejo, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
# legend("bottom", col=1, lty=1,
#        legend=c('Via Varejo'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,4], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,4],betas$Cemig)*0.9,
max(betas_rol_mat[,4],betas$Cemig)*1,1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Cemig, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
par(mfrow=c(2,2))
ts.plot(betas_rol_mat[,1], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,1],betas$Petrobras)*0.9,
max(betas_rol_mat[,1],betas$Petrobras)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Petrobras, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
ts.plot(betas_rol_mat[,2], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,2],betas$Vale)*0.9,
max(betas_rol_mat[,2],betas$Vale)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Vale, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
ylab
# legend("bottom", col=1, lty=1,
#        legend=c('Vale'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,3], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,3],betas$Via_Varejo)*0.9,
max(betas_rol_mat[,3],betas$Via_Varejo)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Via_Varejo, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
# legend("bottom", col=1, lty=1,
#        legend=c('Via Varejo'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,4], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,4],betas$Cemig)*0.9,
max(betas_rol_mat[,4],betas$Cemig)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Cemig, col=1, lty=2)+
abline(h=1, col='gray', lty=1)
par(mfrow=c(2,2))
ts.plot(betas_rol_mat[,1], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,1],betas$Petrobras)*0.9,
max(betas_rol_mat[,1],betas$Petrobras)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Petrobras, col='red', lty=2)+
abline(h=1, col='gray', lty=1)
ts.plot(betas_rol_mat[,2], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,2],betas$Vale)*0.9,
max(betas_rol_mat[,2],betas$Vale)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Vale, col='red', lty=2)+
abline(h=1, col='gray', lty=1)
ylab
# legend("bottom", col=1, lty=1,
#        legend=c('Vale'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,3], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,3],betas$Via_Varejo)*0.9,
max(betas_rol_mat[,3],betas$Via_Varejo)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Via_Varejo, col='red', lty=2)+
abline(h=1, col='gray', lty=1)
# legend("bottom", col=1, lty=1,
#        legend=c('Via Varejo'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,4], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,4],betas$Cemig)*0.9,
max(betas_rol_mat[,4],betas$Cemig)*1.1),
main='Rolling Betas',
ylab = "Beta") +
abline(h=betas$Cemig, col='red', lty=2)+
abline(h=1, col='gray', lty=1)
index(betas_rol_mat) <- index(cmig_filtered)
row.names(betas_rol_mat) <- index(cmig_filtered)
betas_rol_mat
index(as.xts(betas_rol_mat)) <- index(cmig_filtered)
row.names(betas_rol_mat) <- as.Date(index(cmig_filtered))
row.names(betas_rol_mat) <- as.Date(index(cmig_filtered))
betas_rol_mat
as.Date(index(cmig_filtered))
zoo(betas_rol_mat,as.Date(index(cmig_filtered)))
betas_rol_mat <- zoo(betas_rol_mat,as.Date(index(cmig_filtered)))
ts.plot(betas_rol_mat, col=1:4, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Petrobras, col=1, lty=2)+
abline(h=betas$Vale, col=2, lty=2)+
abline(h=betas$Via_Varejo, col=3, lty=2)+
abline(h=betas$Cemig, col=4, lty=2)+
abline(h=1, col='gray', lty=1)
legend("bottom", col=1:2, lty=1,
legend=c('Petrobrás','Vale','Via Varejo','CEMIG'),
lwd = 2, cex=0.6, box.lty=2)
betas_rol_mat
ts.plot(betas_rol_mat, col=1:4, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Petrobras, col=1, lty=2)+
abline(h=betas$Vale, col=2, lty=2)+
abline(h=betas$Via_Varejo, col=3, lty=2)+
abline(h=betas$Cemig, col=4, lty=2)+
abline(h=1, col='gray', lty=1)
legend("bottom", col=1:4, lty=1,
legend=c('Petrobrás','Vale','Via Varejo','CEMIG'),
lwd = 2, cex=0.6, box.lty=2)
as.Date(index(cmig_filtered))
xts(zoo(betas_rol_mat,as.Date(index(cmig_filtered))),order.by = as.Date(index(cmig_filtered)))
betas_rol_mat <- xts(zoo(betas_rol_mat,as.Date(index(cmig_filtered))),order.by = as.Date(index(cmig_filtered)))
ts.plot(betas_rol_mat, col=1:4, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Petrobras, col=1, lty=2)+
abline(h=betas$Vale, col=2, lty=2)+
abline(h=betas$Via_Varejo, col=3, lty=2)+
abline(h=betas$Cemig, col=4, lty=2)+
abline(h=1, col='gray', lty=1)
legend("bottom", col=1:4, lty=1,
legend=c('Petrobrás','Vale','Via Varejo','CEMIG'),
lwd = 2, cex=0.6, box.lty=2)
# Importando as ações
petr <- importa_retorno('PETR4.SA')
par(mfrow = c(2,1))
plot(petr[[1]], main = 'Preço PETR4.SA')
plot(petr[[2]], main = 'Retorno PETR4.SA')
plot(betas_rol_mat, col=1:4, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Petrobras, col=1, lty=2)+
abline(h=betas$Vale, col=2, lty=2)+
abline(h=betas$Via_Varejo, col=3, lty=2)+
abline(h=betas$Cemig, col=4, lty=2)+
abline(h=1, col='gray', lty=1)
plot(betas_rol_mat, col=1:4, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta")
plot(betas_rol_mat, col=1:4, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta") +
abline(h=betas$Petrobras, col=1, lty=2)
plot(betas_rol_mat, col=1:4, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta")
abline(h=betas$Petrobras, col=1, lty=2)
plot(betas_rol_mat, col=1:4, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta")
abline(h=betas$Petrobras, col=1, lty=2)
abline(h=betas$Vale, col=2, lty=2)
abline(h=betas$Via_Varejo, col=3, lty=2)
abline(h=betas$Cemig, col=4, lty=2)
abline(h=1, col='gray', lty=1)
legend("bottom", col=1:4, lty=1,
legend=c('Petrobrás','Vale','Via Varejo','CEMIG'),
lwd = 2, cex=0.6, box.lty=2)
par(mfrow=c(2,2))
plot(betas_rol_mat[,1], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,1],betas$Petrobras)*0.9,
max(betas_rol_mat[,1],betas$Petrobras)*1.1),
main='Rolling Betas',
ylab = "Beta")
abline(h=betas$Petrobras, col='red', lty=2)
abline(h=1, col='gray', lty=1)
ts.plot(betas_rol_mat[,2], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,2],betas$Vale)*0.9,
max(betas_rol_mat[,2],betas$Vale)*1.1),
main='Rolling Betas',
ylab = "Beta")
abline(h=betas$Vale, col='red', lty=2)
abline(h=1, col='gray', lty=1)
ylab
# legend("bottom", col=1, lty=1,
#        legend=c('Vale'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,3], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,3],betas$Via_Varejo)*0.9,
max(betas_rol_mat[,3],betas$Via_Varejo)*1.1),
main='Rolling Betas',
ylab = "Beta")
abline(h=betas$Via_Varejo, col='red', lty=2)
abline(h=1, col='gray', lty=1)
# legend("bottom", col=1, lty=1,
#        legend=c('Via Varejo'),
#        lwd = 2, cex=0.6, box.lty=2)
ts.plot(betas_rol_mat[,4], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,4],betas$Cemig)*0.9,
max(betas_rol_mat[,4],betas$Cemig)*1.1),
main='Rolling Betas',
ylab = "Beta")
abline(h=betas$Cemig, col='red', lty=2)
abline(h=1, col='gray', lty=1)
par(mfrow=c(2,2))
plot(betas_rol_mat[,1], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,1],betas$Petrobras)*0.9,
max(betas_rol_mat[,1],betas$Petrobras)*1.1),
main='Rolling Betas',
ylab = "Beta")
abline(h=betas$Petrobras, col='red', lty=2)
abline(h=1, col='gray', lty=1)
plot(betas_rol_mat[,2], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,2],betas$Vale)*0.9,
max(betas_rol_mat[,2],betas$Vale)*1.1),
main='Rolling Betas',
ylab = "Beta")
abline(h=betas$Vale, col='red', lty=2)
abline(h=1, col='gray', lty=1)
ylab
# legend("bottom", col=1, lty=1,
#        legend=c('Vale'),
#        lwd = 2, cex=0.6, box.lty=2)
plot(betas_rol_mat[,3], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,3],betas$Via_Varejo)*0.9,
max(betas_rol_mat[,3],betas$Via_Varejo)*1.1),
main='Rolling Betas',
ylab = "Beta")
abline(h=betas$Via_Varejo, col='red', lty=2)
abline(h=1, col='gray', lty=1)
# legend("bottom", col=1, lty=1,
#        legend=c('Via Varejo'),
#        lwd = 2, cex=0.6, box.lty=2)
plot(betas_rol_mat[,4], col=1, lwd=2,
ylim=c(min(betas_rol_mat[,4],betas$Cemig)*0.9,
max(betas_rol_mat[,4],betas$Cemig)*1.1),
main='Rolling Betas',
ylab = "Beta")
abline(h=betas$Cemig, col='red', lty=2)
abline(h=1, col='gray', lty=1)
plot(petr_filtered)
index(petr_filtered)
index(petr_filtered) == index(ibov_filtered)
sum(index(petr_filtered) == index(ibov_filtered))
nrow(petr_filtered)
sum(index(petr_filtered) == index(vale_filtered))
sum(index(petr_filtered) == index(vvar_filtered))
sum(index(petr_filtered) == index(cmig_filtered))
row.names(betas_rol_mat) <- as.Date(index(cmig_filtered))
petr_filtered <- datas_comuns_5(petr[[2]],vale[[2]],vvar[[2]],cmig[[2]],ibov[[2]])
ibov_filtered <- datas_comuns_5(ibov[[2]],petr[[2]],vale[[2]],vvar[[2]],cmig[[2]])
vale_filtered <- datas_comuns_5(vale[[2]],petr[[2]],vvar[[2]],cmig[[2]],ibov[[2]])
vvar_filtered <- datas_comuns_5(vvar[[2]],vale[[2]],petr[[2]],cmig[[2]],ibov[[2]])
cmig_filtered <- datas_comuns_5(cmig[[2]],vvar[[2]],vale[[2]],petr[[2]],ibov[[2]])
init = round(nrow(ibov_filtered)/2, 0)
out = nrow(ibov_filtered) - init
betas_rol = tibble(Petr = NA, Vale = NA, VVar = NA, CMIG = NA)
for (t in 1:out){
petr_fit2 = lm(petr_filtered[t:(init+t)] ~ ibov_filtered[t:(init+t)])
vale_fit2 = lm(vale_filtered[t:(init+t)] ~ ibov_filtered[t:(init+t)])
vvar_fit2 = lm(vvar_filtered[t:(init+t)] ~ ibov_filtered[t:(init+t)])
cmig_fit2 = lm(cmig_filtered[t:(init+t)] ~ ibov_filtered[t:(init+t)])
betas_rol = betas_rol %>% bind_rows(
tibble(Petr = petr_fit2$coefficients[2],
Vale = vale_fit2$coefficients[2],
VVar = vvar_fit2$coefficients[2],
CMIG = cmig_fit2$coefficients[2])
)
}
# Importando as ações
petr <- importa_retorno('PETR4.SA')
# Importando as ações
petr <- importa_retorno('PETR4.SA')
summary(petr[[1]])
summary(petr[[1]])
par(mfrow = c(2,1))
plot(petr[[1]], main = 'Preço PETR4.SA')
plot(petr[[2]], main = 'Retorno PETR4.SA')
par(mfrow = c(2,1))
plot(petr[[1]], main = 'Preço PETR4.SA')
plot(petr[[2]], main = 'Retorno PETR4.SA')
## Ações - Vale do Rio Doce
```{r importando_vale, cache=TRUE}
vale <- importa_retorno('VALE3.SA')
summary(vale[[1]])
par(mfrow = c(2,1))
plot(vale[[1]], main = 'Preço VALE3.SA')
plot(vale[[2]], main = 'Retorno VALE3.SA')
vvar <- importa_retorno('VVAR3.SA')
vvar <- importa_retorno('VVAR3.SA')
summary(vvar[[1]])
par(mfrow = c(2,1))
par(mfrow = c(2,1))
plot(vvar[[1]], main = 'Preço VVAR3.SA')
plot(vvar[[2]], main = 'Retorno VVAR3.SA')
cmig <- importa_retorno('CMIG4.SA')
cmig <- importa_retorno('CMIG4.SA')
summary(cmig[[1]])
summary(cmig[[1]])
par(mfrow = c(2,1))
plot(cmig[[1]], main = 'Preço CMIG4.SA')
plot(cmig[[1]], main = 'Preço CMIG4.SA')
plot(cmig[[2]], main = 'Retorno CMIG4.SA')
ibov <- importa_retorno('^BVSP')
summary(ibov[[1]])
ibov[[2]] %>% na.omit() %>% length()
petr[[2]] %>% length()
par(mfrow = c(2,1))
plot(ibov[[1]], main = 'Pontos IBOVESPA')
plot(ibov[[2]], main = 'Retorno IBOVESPA')
selic <- BETSget(code = "11", from = "2007-01-02")
selic <- BETSget(code = "11", from = "2007-01-02")
rf <- xts(selic$value*0.01, order.by = selic$date)
summary(rf)
par(mfrow = c(2,1))
plot(rf, main = 'Pontos SELIC')
# Filtrando somente pelas datas que existem nas duas séries
titulos <- c('PETROBRAS','IBOVESPA','Modelo de Mercado')
papel1 <- petr[[2]]
papel2 <- ibov[[2]]
papel1_filtered <- datas_comuns(papel1,papel2)
papel2_filtered <- datas_comuns(papel2,papel1)
papel1_fit = lm(papel1_filtered ~ papel2_filtered)
summary(papel1_fit)
beta_petr <- papel1_fit$coefficients[2]
MSE_petr_estatico = mean((papel1_fit$fitted.values - papel1_filtered)^2)
MAE_petr_estatico = mean(abs(papel1_fit$fitted.values - papel1_filtered))
par(mfrow=c(1,1))
plot(as.vector(papel2_filtered),as.vector(papel1_filtered),cex=0.8, col='darkblue',xlim = c(-0.15,0.1),ylim = c(-0.15,0.2),
ylab=titulos[1], xlab = titulos[2],main=titulos[3])
abline(papel1_fit$coefficients, lwd=2)
par(mfrow=c(1,1))
plot(as.vector(papel2_filtered),as.vector(papel1_filtered),cex=0.8, col='darkblue',xlim = c(-0.15,0.1),ylim = c(-0.15,0.2),
ylab=titulos[1], xlab = titulos[2],main=titulos[3])
abline(papel1_fit$coefficients, lwd=2)
titulos <- c('VALE','IBOVESPA','Modelo de Mercado')
papel1 <- vale[[2]]
papel2 <- ibov[[2]]
papel1_filtered <- datas_comuns(papel1,papel2)
papel2_filtered <- datas_comuns(papel2,papel1)
papel1_fit = lm(papel1_filtered ~ papel2_filtered)
summary(papel1_fit)
beta_vale <- papel1_fit$coefficients[2]
MSE_vale_estatico = mean((papel1_fit$fitted.values - papel1_filtered)^2)
MAE_vale_estatico = mean(abs(papel1_fit$fitted.values - papel1_filtered))
par(mfrow=c(1,1))
plot(as.vector(papel2_filtered),as.vector(papel1_filtered),cex=0.8, col='darkblue',xlim = c(-0.15,0.1),ylim = c(-0.15,0.2),
ylab=titulos[1], xlab = titulos[2],main=titulos[3])
abline(papel1_fit$coefficients, lwd=2)
titulos <- c('VIA VAREJO','IBOVESPA','Modelo de Mercado')
papel1 <- vvar[[2]]
papel2 <- ibov[[2]]
papel1_filtered <- datas_comuns(papel1,papel2)
papel2_filtered <- datas_comuns(papel2,papel1)
papel1_fit = lm(papel1_filtered ~ papel2_filtered)
summary(papel1_fit)
beta_vvar <- papel1_fit$coefficients[2]
MSE_vvar_estatico = mean((papel1_fit$fitted.values - papel1_filtered)^2)
MAE_vvar_estatico = mean(abs(papel1_fit$fitted.values - papel1_filtered))
par(mfrow=c(1,1))
plot(as.vector(papel2_filtered),as.vector(papel1_filtered),cex=0.8, col='darkblue',xlim = c(-0.15,0.1),ylim = c(-0.15,0.2),
ylab=titulos[1], xlab = titulos[2],main=titulos[3])
abline(papel1_fit$coefficients, lwd=2)
titulos <- c('CEMIG','IBOVESPA','Modelo de Mercado')
papel1 <- cmig[[2]]
papel2 <- ibov[[2]]
papel1_filtered <- datas_comuns(papel1,papel2)
papel2_filtered <- datas_comuns(papel2,papel1)
papel1_fit = lm(papel1_filtered ~ papel2_filtered)
summary(papel1_fit)
beta_cmig <- papel1_fit$coefficients[2]
MSE_cmig_estatico = mean((papel1_fit$fitted.values - papel1_filtered)^2)
MAE_cmig_estatico = mean(abs(papel1_fit$fitted.values - papel1_filtered))
par(mfrow=c(1,1))
plot(as.vector(papel2_filtered),as.vector(papel1_filtered),cex=0.8, col='darkblue',xlim = c(-0.15,0.1),ylim = c(-0.15,0.2),
ylab=titulos[1], xlab = titulos[2],main=titulos[3])
abline(papel1_fit$coefficients, lwd=2)
betas <- tibble(Petrobras = round(beta_petr,3),
Vale = round(beta_vale,3),
Via_Varejo = round(beta_vvar,3),
Cemig = round(beta_cmig,3))
DT::datatable(betas)
petr_filtered <- datas_comuns_5(petr[[2]],vale[[2]],vvar[[2]],cmig[[2]],ibov[[2]])
ibov_filtered <- datas_comuns_5(ibov[[2]],petr[[2]],vale[[2]],vvar[[2]],cmig[[2]])
vale_filtered <- datas_comuns_5(vale[[2]],petr[[2]],vvar[[2]],cmig[[2]],ibov[[2]])
vvar_filtered <- datas_comuns_5(vvar[[2]],vale[[2]],petr[[2]],cmig[[2]],ibov[[2]])
cmig_filtered <- datas_comuns_5(cmig[[2]],vvar[[2]],vale[[2]],petr[[2]],ibov[[2]])
init = round(nrow(ibov_filtered)/2, 0)
out = nrow(ibov_filtered) - init
betas_rol = tibble(Petr = NA, Vale = NA, VVar = NA, CMIG = NA)
for (t in 1:out){
petr_fit2 = lm(petr_filtered[t:(init+t)] ~ ibov_filtered[t:(init+t)])
vale_fit2 = lm(vale_filtered[t:(init+t)] ~ ibov_filtered[t:(init+t)])
vvar_fit2 = lm(vvar_filtered[t:(init+t)] ~ ibov_filtered[t:(init+t)])
cmig_fit2 = lm(cmig_filtered[t:(init+t)] ~ ibov_filtered[t:(init+t)])
betas_rol = betas_rol %>% bind_rows(
tibble(Petr = petr_fit2$coefficients[2],
Vale = vale_fit2$coefficients[2],
VVar = vvar_fit2$coefficients[2],
CMIG = cmig_fit2$coefficients[2])
)
}
betas_rol <- betas_rol %>% na.omit()
?plot
plot(betas_rol_mat, col=1:4, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta")
abline(h=betas$Petrobras, col=1, lty=2)
abline(h=betas$Vale, col=2, lty=2)
abline(h=betas$Via_Varejo, col=3, lty=2)
abline(h=betas$Cemig, col=4, lty=2)
abline(h=1, col='gray', lty=1)
legend("right", col=1:4, lty=1,
legend=c('Petrobrás','Vale','Via Varejo','CEMIG'),
lwd = 2, cex=0.6, box.lty=2)
plot(betas_rol_mat, col=1:4, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta")
abline(h=betas$Petrobras, col=1, lty=2)
abline(h=betas$Vale, col=2, lty=2)
abline(h=betas$Via_Varejo, col=3, lty=2)
abline(h=betas$Cemig, col=4, lty=2)
abline(h=1, col='gray', lty=1)
legend(col=1:4, lty=1,
legend=c('Petrobrás','Vale','Via Varejo','CEMIG'),
lwd = 2, cex=0.6, box.lty=2)
plot(betas_rol_mat, col=1:4, lwd=2, ylim=c(0,2), main='Rolling Betas',ylab = "Beta")
abline(h=betas$Petrobras, col=1, lty=2)
abline(h=betas$Vale, col=2, lty=2)
abline(h=betas$Via_Varejo, col=3, lty=2)
abline(h=betas$Cemig, col=4, lty=2)
abline(h=1, col='gray', lty=1)
legend("right", col=1:4, lty=1,
legend=c('Petrobrás','Vale','Via Varejo','CEMIG'),
lwd = 2, cex=0.6, box.lty=2)
